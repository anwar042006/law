<!DOCTYPE html>
<html lang="en">
<head>
  <meta charset="UTF-8" />
  <title>Blockchain Evidence Tracking</title>
  <style>
    body {
      background-color: #121212;
      color: #f0f0f0;
      font-family: Arial, sans-serif;
      text-align: center;
      padding: 20px;
    }
    .container {
      background-color: #1e1e1e;
      padding: 20px;
      margin: 10px auto;
      border-radius: 12px;
      width: 90%;
      max-width: 600px;
      box-shadow: 0 0 10px #00b89488;
    }
    input, button, select, textarea {
      width: 100%;
      padding: 10px;
      margin-top: 10px;
      border-radius: 6px;
      border: none;
      font-size: 1em;
    }
    input, textarea {
      background-color: #2c2c2c;
      color: #fff;
    }
    button {
      background-color: #00b894;
      color: #121212;
      font-weight: bold;
      cursor: pointer;
    }
    button:hover {
      background-color: #019e76;
    }
    h2 {
      color: #00b894;
    }
    pre {
      text-align: left;
      background: #272727;
      padding: 1em;
      border-radius: 10px;
      white-space: pre-wrap;
      box-shadow: inset 0 0 10px #00b89466;
    }
  </style>
</head>
<body>

<h2>Evidence Tracking System</h2>

<div class="container" id="roleSelect">
  <h3>Select Role</h3>
  <button onclick="selectRole('police')">Police</button>
  <button onclick="selectRole('court')">Court</button>
  <button onclick="selectRole('public')">Public</button>
</div>

<div class="container" id="loginBox" style="display:none;">
  <h3>Login</h3>
  <input type="text" id="loginId" placeholder="User ID" />
  <input type="password" id="loginPass" placeholder="Password" />
  <button onclick="doLogin()">Login</button>
  <p id="loginError" style="color:red;"></p>
</div>

<!-- Police Interface -->
<div class="container" id="policeBox" style="display:none;">
  <h3>Submit Evidence (Police)</h3>
  <input id="autoUniqueId" placeholder="Unique Case ID" readonly />
  <input id="autoEvidenceId" placeholder="Evidence ID" readonly />
  <input id="caseName" placeholder="Case Name" />
  <input id="accusedName" placeholder="Accused Name" />
  <input id="location" placeholder="Location" />
  <input id="officerName" placeholder="Officer Name" />
  <input type="datetime-local" id="registerTime" />
  <button onclick="submitEvidence()">Submit Evidence</button>
</div>

<!-- Court Interface -->
<div class="container" id="courtBox" style="display:none;">
  <h3>Add Judgment (Court)</h3>
  <input id="filterInput" placeholder="Search by Evidence ID or Name" oninput="populateSelect()" />
  <select id="caseSelect">
    <option value="">-- Select Evidence ID --</option>
  </select>
  <textarea id="judgmentText" placeholder="Enter Judgment..."></textarea>
  <input type="date" id="closingDate" />
  <button onclick="submitJudgment()">Submit Judgment</button>
</div>

<!-- Public & Shared: Tracking -->
<div class="container" id="trackBox" style="display:none;">
  <h3>Track Evidence</h3>
  <input id="searchKey" placeholder="Evidence ID or Accused Name" />
  <button onclick="searchEvidence()">Search</button>
  <pre id="resultBox">Results will appear here...</pre>
</div>

<script>
  const users = {
    officer1: { password: "1234", role: "police" },
    court1: { password: "abcd", role: "court" }
  };

  let selectedRole = "";

  function selectRole(role) {
    selectedRole = role;
    document.getElementById("roleSelect").style.display = "none";

    if (role === "public") {
      document.getElementById("trackBox").style.display = "block";
    } else {
      document.getElementById("loginBox").style.display = "block";
    }
  }

  function doLogin() {
    const id = document.getElementById("loginId").value;
    const pass = document.getElementById("loginPass").value;
    const user = users[id];

    if (user && user.password === pass && user.role === selectedRole) {
      document.getElementById("loginBox").style.display = "none";
      document.getElementById("trackBox").style.display = "block";

      if (user.role === "police") {
        document.getElementById("policeBox").style.display = "block";
        generateIds();
      } else if (user.role === "court") {
        document.getElementById("courtBox").style.display = "block";
        populateSelect();
      }
    } else {
      document.getElementById("loginError").textContent = "Invalid login.";
    }
  }

  function generateIds() {
    const db = JSON.parse(localStorage.getItem("evidenceDB") || "[]");
    const index = db.length + 1;
    document.getElementById("autoUniqueId").value = "CASE" + String(index).padStart(3, '0');
    document.getElementById("autoEvidenceId").value = "EVID" + String(index).padStart(3, '0');
  }

  function submitEvidence() {
    const db = JSON.parse(localStorage.getItem("evidenceDB") || "[]");

    const data = {
      uniqueId: document.getElementById("autoUniqueId").value,
      evidenceId: document.getElementById("autoEvidenceId").value,
      caseName: document.getElementById("caseName").value,
      accusedName: document.getElementById("accusedName").value,
      location: document.getElementById("location").value,
      officerName: document.getElementById("officerName").value,
      registerTime: document.getElementById("registerTime").value,
      judgment: "",
      closingDate: ""
    };

    if (!data.caseName || !data.accusedName || !data.location || !data.officerName || !data.registerTime) {
      alert("Please fill all required fields.");
      return;
    }

    db.push(data);
    localStorage.setItem("evidenceDB", JSON.stringify(db));
    alert("Evidence Submitted.");

    populateSelect();
    document.querySelectorAll("#policeBox input, #policeBox textarea").forEach(el => el.value = "");
    generateIds();
  }

  function searchEvidence() {
    const key = document.getElementById("searchKey").value.trim().toLowerCase();
    const db = JSON.parse(localStorage.getItem("evidenceDB") || "[]");

    const result = db.find(
      e => e.evidenceId.toLowerCase() === key || e.accusedName.toLowerCase() === key
    );

    const box = document.getElementById("resultBox");
    if (result) {
      box.textContent = `
üÜî Case ID: ${result.uniqueId}
üìÅ Case Name: ${result.caseName}
üë§ Accused: ${result.accusedName}
üìÑ Evidence ID: ${result.evidenceId}
üìç Location: ${result.location}
üëÆ Officer: ${result.officerName}
üïí Registered On: ${new Date(result.registerTime).toLocaleString()}
‚öñ Judgment: ${result.judgment || "Pending"}
üìÖ Closing Date: ${result.closingDate || "Pending"}
`;
    } else {
      box.textContent = "No record found.";
    }
  }

  function populateSelect() {
    const db = JSON.parse(localStorage.getItem("evidenceDB") || "[]");
    const filter = document.getElementById("filterInput").value.trim().toLowerCase();
    const select = document.getElementById("caseSelect");
    select.innerHTML = '<option value="">-- Select Evidence ID --</option>';

    db.forEach(e => {
      if (
        e.evidenceId.toLowerCase().includes(filter) ||
        e.accusedName.toLowerCase().includes(filter)
      ) {
        const option = document.createElement("option");
        option.value = e.evidenceId;
        option.text = ${e.evidenceId} (${e.accusedName});
        select.appendChild(option);
      }
    });
  }

  function submitJudgment() {
    const id = document.getElementById("caseSelect").value;
    const judgment = document.getElementById("judgmentText").value;
    const date = document.getElementById("closingDate").value;

    if (!id || !judgment || !date) {
      alert("Fill all fields.");
      return;
    }

    const db = JSON.parse(localStorage.getItem("evidenceDB") || "[]");
    const entry = db.find(e => e.evidenceId === id);

    if (entry) {
      entry.judgment = judgment;
      entry.closingDate = date;
      localStorage.setItem("evidenceDB", JSON.stringify(db));
      alert("Judgment submitted.");
      document.getElementById("judgmentText").value = "";
      document.getElementById("closingDate").value = "";
    }
  }
</script>

</body>
</html>
